<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Матриця Долі — Тест</title>
<style>
    body {
        font-family: Arial, sans-serif;
        background: #f9f9f9;
        color: #333;
        text-align: center;
        margin: 0;
        padding: 0;
    }
    header {
        padding: 20px;
    }
    input {
        padding: 8px;
        font-size: 1em;
        margin-top: 10px;
    }
    canvas {
        background: #fff;
        border: 1px solid #ccc;
        max-width: 100%;
        height: auto;
    }
</style>
</head>
<body>

<header>
    <h1>Матриця Долі</h1>
    <p>Введіть дату народження:</p>
    <input type="date" id="birthdate" onchange="updateMatrix()">
</header>

<canvas id="matrixCanvas" width="600" height="600"></canvas>

<script>
const canvas = document.getElementById("matrixCanvas");
const ctx = canvas.getContext("2d");

const points = {
    A: {}, A1: {}, A2: {},
    B: {}, B1: {}, B2: {},
    V: {}, V1: {}, V2: {},
    G: {}, G1: {}, G2: {},
    D: {},
    E: {}, E1: {}, E2: {},
    Zh: {}, Zh1: {}, Zh2: {},
    Z: {}, Z1: {}, Z2: {},
    I: {}, I1: {}, I2: {},
    O: {}, M: {}, N: {}
};

function resizeCanvas() {
    const size = Math.min(window.innerWidth * 0.9, 600);
    canvas.width = size;
    canvas.height = size;
    drawMatrix();
}
window.addEventListener('resize', resizeCanvas);

function drawCircle(x, y, r, color, text) {
    ctx.beginPath();
    ctx.arc(x, y, r, 0, Math.PI * 2);
    ctx.fillStyle = color;
    ctx.fill();
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 1.5;
    ctx.stroke();
    ctx.fillStyle = "#000";
    ctx.font = `${r}px Arial`;
    ctx.textAlign = "center";
    ctx.textBaseline = "middle";
    ctx.fillText(text, x, y);
}

function drawLine(x1, y1, x2, y2) {
    ctx.beginPath();
    ctx.moveTo(x1, y1);
    ctx.lineTo(x2, y2);
    ctx.strokeStyle = "#000";
    ctx.lineWidth = 1;
    ctx.stroke();
}

function drawMatrix() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    const cx = canvas.width / 2;
    const cy = canvas.height / 2;
    const s = canvas.width / 600;

    // Приблизні координати (потрібно буде відточити по шаблону)
    points.A = {x: cx, y: cy - 200*s, r: 20*s, color: "#FFB6C1"};
    points.A1 = {x: cx - 50*s, y: cy - 170*s, r: 15*s, color: "#FFD700"};
    points.A2 = {x: cx + 50*s, y: cy - 170*s, r: 15*s, color: "#FFD700"};

    points.B = {x: cx - 200*s, y: cy, r: 20*s, color: "#87CEFA"};
    points.B1 = {x: cx - 170*s, y: cy - 50*s, r: 15*s, color: "#FFD700"};
    points.B2 = {x: cx - 170*s, y: cy + 50*s, r: 15*s, color: "#FFD700"};

    points.V = {x: cx, y: cy + 200*s, r: 20*s, color: "#90EE90"};
    points.V1 = {x: cx - 50*s, y: cy + 170*s, r: 15*s, color: "#FFD700"};
    points.V2 = {x: cx + 50*s, y: cy + 170*s, r: 15*s, color: "#FFD700"};

    points.G = {x: cx + 200*s, y: cy, r: 20*s, color: "#FFA07A"};
    points.G1 = {x: cx + 170*s, y: cy - 50*s, r: 15*s, color: "#FFD700"};
    points.G2 = {x: cx + 170*s, y: cy + 50*s, r: 15*s, color: "#FFD700"};

    points.D = {x: cx, y: cy, r: 25*s, color: "#BA55D3"};

    points.E = {x: cx - 140*s, y: cy - 140*s, r: 18*s, color: "#ADD8E6"};
    points.E1 = {x: cx - 100*s, y: cy - 100*s, r: 12*s, color: "#FFD700"};
    points.E2 = {x: cx - 60*s, y: cy - 60*s, r: 12*s, color: "#FFD700"};

    points.Zh = {x: cx + 140*s, y: cy - 140*s, r: 18*s, color: "#ADD8E6"};
    points.Zh1 = {x: cx + 100*s, y: cy - 100*s, r: 12*s, color: "#FFD700"};
    points.Zh2 = {x: cx + 60*s, y: cy - 60*s, r: 12*s, color: "#FFD700"};

    points.Z = {x: cx - 140*s, y: cy + 140*s, r: 18*s, color: "#ADD8E6"};
    points.Z1 = {x: cx - 100*s, y: cy + 100*s, r: 12*s, color: "#FFD700"};
    points.Z2 = {x: cx - 60*s, y: cy + 60*s, r: 12*s, color: "#FFD700"};

    points.I = {x: cx + 140*s, y: cy + 140*s, r: 18*s, color: "#ADD8E6"};
    points.I1 = {x: cx + 100*s, y: cy + 100*s, r: 12*s, color: "#FFD700"};
    points.I2 = {x: cx + 60*s, y: cy + 60*s, r: 12*s, color: "#FFD700"};

    points.O = {x: cx, y: cy - 100*s, r: 14*s, color: "#FFDEAD"};
    points.M = {x: cx - 100*s, y: cy, r: 14*s, color: "#FFDEAD"};
    points.N = {x: cx, y: cy + 100*s, r: 14*s, color: "#FFDEAD"};

    // Лінії (приклад основних)
    drawLine(points.A.x, points.A.y, points.D.x, points.D.y);
    drawLine(points.B.x, points.B.y, points.D.x, points.D.y);
    drawLine(points.V.x, points.V.y, points.D.x, points.D.y);
    drawLine(points.G.x, points.G.y, points.D.x, points.D.y);
    drawLine(points.E.x, points.E.y, points.I.x, points.I.y);
    drawLine(points.Zh.x, points.Zh.y, points.Z.x, points.Z.y);

    // Малюємо точки
    for (let key in points) {
        drawCircle(points[key].x, points[key].y, points[key].r, points[key].color, points[key].value || "0");
    }
}

function calculatePointValues(date) {
    // Тестові значення (рандом від 1 до 22)
    for (let key in points) {
        points[key].value = Math.floor(Math.random() * 22) + 1;
    }
}

function updateMatrix() {
    const date = document.getElementById("birthdate").value;
    if (!date) return;
    calculatePointValues(date);
    animateNumbers();
}

function animateNumbers() {
    let step = 0;
    const steps = 20;
    const startValues = {};
    const endValues = {};
    for (let key in points) {
        startValues[key] = 0;
        endValues[key] = points[key].value;
    }

    function frame() {
        step++;
        for (let key in points) {
            const progress = step / steps;
            points[key].currentValue = Math.floor(startValues[key] + (endValues[key] - startValues[key]) * progress);
        }
        drawMatrixWithAnimation();
        if (step < steps) requestAnimationFrame(frame);
    }
    frame();
}

function drawMatrixWithAnimation() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    for (let key in points) {
        drawCircle(points[key].x, points[key].y, points[key].r, points[key].color, points[key].currentValue || "0");
    }
}

resizeCanvas();
</script>

</body>
</html>
